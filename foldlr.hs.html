[34;2m-- Copyright (c) 2013 Bart Massey[0m[0m
[0m[34;2m-- Reconstruction of `foldlr` primitive.[0m[0m
[0m[0m
[0m[34mfoldlr[0m[0m [0m[31m::[0m[0m [0m[36m([0m[0ml[0m[0m [0m[31m->[0m[0m [0m[0mx[0m[0m [0m[31m->[0m[0m [0m[0mr[0m[0m [0m[31m->[0m[0m [0m[36m([0m[0ml[0m[36m,[0m[0m [0m[0mr[0m[36m)[0m[36m)[0m[0m [0m[31m->[0m[0m [0m[0ml[0m[0m [0m[31m->[0m[0m [0m[0mr[0m[0m [0m[31m->[0m[0m [0m[31m[[0m[0mx[0m[31m][0m[0m [0m[31m->[0m[0m [0m[36m([0m[0ml[0m[36m,[0m[0m [0m[0mr[0m[36m)[0m[0m
[0m[34mfoldlr[0m[0m [0m[32;4m_[0m[0m [0m[0ml[0m[0m [0m[0mr0[0m[0m [0m[0m[][0m[0m [0m[31m=[0m[0m [0m[36m([0m[0ml[0m[36m,[0m[0m [0m[0mr0[0m[36m)[0m[0m
[0m[34mfoldlr[0m[0m [0m[0mf[0m[0m [0m[0ml[0m[0m [0m[0mr[0m[0m [0m[36m([0m[0mx[0m[0m [0m[31;1m:[0m[0m [0m[0mxs[0m[36m)[0m[0m [0m[31m=[0m[0m
[0m[0m  [0m[32;4mlet[0m[0m [0m[36m([0m[0ml'[0m[36m,[0m[0m [0m[0mr'[0m[36m)[0m[0m [0m[31m=[0m[0m [0m[0mf[0m[0m [0m[0ml[0m[0m [0m[0mx[0m[0m [0m[0mr''[0m[0m
[0m[0m      [0m[36m([0m[0ml''[0m[36m,[0m[0m [0m[0mr''[0m[36m)[0m[0m [0m[31m=[0m[0m [0m[0mfoldlr[0m[0m [0m[0mf[0m[0m [0m[0ml'[0m[0m [0m[0mr[0m[0m [0m[0mxs[0m[0m [0m[32;4min[0m[0m
[0m[0m  [0m[36m([0m[0ml''[0m[36m,[0m[0m [0m[0mr'[0m[36m)[0m[0m
[0m[0m
[0m[34mfoldl[0m[0m [0m[31m::[0m[0m [0m[36m([0m[0ma[0m[0m [0m[31m->[0m[0m [0m[0mx[0m[0m [0m[31m->[0m[0m [0m[0ma[0m[36m)[0m[0m [0m[31m->[0m[0m [0m[0ma[0m[0m [0m[31m->[0m[0m [0m[31m[[0m[0mx[0m[31m][0m[0m [0m[31m->[0m[0m [0m[0ma[0m[0m
[0m[34mfoldl[0m[0m [0m[0mf[0m[0m [0m[0ma0[0m[0m [0m[0mxs[0m[0m [0m[31m=[0m[0m
[0m[0m  [0m[0mfst[0m[0m [0m[36m$[0m[0m [0m[0mfoldlr[0m[0m [0m[36m([0m[31m\[0m[0ml[0m[0m [0m[0mx[0m[0m [0m[32;4m_[0m[0m [0m[31m->[0m[0m [0m[36m([0m[0mf[0m[0m [0m[0ml[0m[0m [0m[0mx[0m[36m,[0m[0m [0m[0mundefined[0m[36m)[0m[36m)[0m[0m [0m[0ma0[0m[0m [0m[0mundefined[0m[0m [0m[0mxs[0m[0m
[0m[0m
[0m[34mfoldr[0m[0m [0m[31m::[0m[0m [0m[36m([0m[0mx[0m[0m [0m[31m->[0m[0m [0m[0ma[0m[0m [0m[31m->[0m[0m [0m[0ma[0m[36m)[0m[0m [0m[31m->[0m[0m [0m[0ma[0m[0m [0m[31m->[0m[0m [0m[31m[[0m[0mx[0m[31m][0m[0m [0m[31m->[0m[0m [0m[0ma[0m[0m
[0m[34mfoldr[0m[0m [0m[0mf[0m[0m [0m[0ma0[0m[0m [0m[0mxs[0m[0m [0m[31m=[0m[0m
[0m[0m  [0m[0msnd[0m[0m [0m[36m$[0m[0m [0m[0mfoldlr[0m[0m [0m[36m([0m[31m\[0m[32;4m_[0m[0m [0m[0mx[0m[0m [0m[0mr[0m[0m [0m[31m->[0m[0m [0m[36m([0m[0mundefined[0m[36m,[0m[0m [0m[0mf[0m[0m [0m[0mx[0m[0m [0m[0mr[0m[36m)[0m[36m)[0m[0m [0m[0mundefined[0m[0m [0m[0ma0[0m[0m [0m[0mxs[0m[0m
[0m[0m
[0m[34mmapAccumL[0m[0m [0m[31m::[0m[0m [0m[36m([0m[0ma[0m[0m [0m[31m->[0m[0m [0m[0mx[0m[0m [0m[31m->[0m[0m [0m[36m([0m[0ma[0m[36m,[0m[0m [0m[0my[0m[36m)[0m[36m)[0m[0m [0m[31m->[0m[0m [0m[0ma[0m[0m [0m[31m->[0m[0m [0m[31m[[0m[0mx[0m[31m][0m[0m [0m[31m->[0m[0m [0m[36m([0m[0ma[0m[36m,[0m[0m [0m[31m[[0m[0my[0m[31m][0m[36m)[0m[0m
[0m[34mmapAccumL[0m[0m [0m[0mf[0m[0m [0m[0ma0[0m[0m [0m[0mxs[0m[0m [0m[31m=[0m[0m
[0m[0m  [0m[0mfoldlr[0m[0m [0m[0mg[0m[0m [0m[0ma0[0m[0m [0m[0m[][0m[0m [0m[0mxs[0m[0m
[0m[0m  [0m[32;4mwhere[0m[0m
[0m[0m    [0m[0mg[0m[0m [0m[0ml[0m[0m [0m[0mx[0m[0m [0m[0mr[0m[0m [0m[31m=[0m[0m
[0m[0m      [0m[32;4mlet[0m[0m [0m[36m([0m[0ml'[0m[36m,[0m[0m [0m[0my[0m[36m)[0m[0m [0m[31m=[0m[0m [0m[0mf[0m[0m [0m[0ml[0m[0m [0m[0mx[0m[0m [0m[32;4min[0m[0m
[0m[0m      [0m[36m([0m[0ml'[0m[36m,[0m[0m [0m[0my[0m[0m [0m[31;1m:[0m[0m [0m[0mr[0m[36m)[0m[0m
[0m[0m
[0m[34msumSum[0m[0m [0m[31m::[0m[0m [0m[31m[[0m[0mInt[0m[31m][0m[0m [0m[31m->[0m[0m [0m[36m([0m[0mInt[0m[36m,[0m[0m [0m[31m[[0m[0mInt[0m[31m][0m[36m)[0m[0m
[0m[34msumSum[0m[0m [0m[0mxs[0m[0m [0m[31m=[0m[0m [0m[0mmapAccumL[0m[0m [0m[36m([0m[31m\[0m[0ma[0m[0m [0m[0mx[0m[0m [0m[31m->[0m[0m [0m[36m([0m[0ma[0m[0m [0m[36m+[0m[0m [0m[35m1[0m[36m,[0m[0m [0m[0ma[0m[0m [0m[36m+[0m[0m [0m[0mx[0m[36m)[0m[36m)[0m[0m [0m[35m0[0m[0m [0m[0mxs[0m[0m
[0m